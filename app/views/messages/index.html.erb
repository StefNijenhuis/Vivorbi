<% content_for :title, t('messages.search.title') %>
<% if @search_error.present? %>
  <div class="row">
    <div class="large-12 small-12 columns">
      <div class="error">
        <%=@search_error%>
      </div>
    </div>
  </div>
<% else %>
  <div class="row">
    <div class="small-12 large-12 columns">
      <div class="search_result_menu">
        <div class="row">
          <div class="small-12 large-6 columns">
            <% if !@keyword.empty? %>
              <%=@messages.count + @comments.count%> <%=t'search.results.keyword'%> "<%=@keyword%>"
            <% else %>
              <%=@messages.count%> <%=t 'search.results.postal'%> <%=@location['street']%>, <%=@location['postcode']%> <%=@location['town']%>
            <% end %>
          </div>
          <div class="show-for-medium-up large-2 columns">
            <%= t 'search.category' %>
          </div>
          <div class="show-for-medium-up large-2 columns">
            <% unless @postal_code.empty? %>
              <%=t 'search.distance' %>
            <% end %>
          </div>
          <div class="show-for-medium-up large-2 columns">
            <%=t 'search.date' %>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>

<% if (@messages == nil || @messages.empty?) && (@comments == nil || @comments.empty?) %>
  <% unless @search_error.present? %>
    <div class="row">
      <div class="large-12 small-12 columns">
        <div class=" large-12 columns no_result">
          <div class="large-12 small-12 columns">
            <%=t 'search.no_results' %>
          </div>
          <div class="large-3 small-12 columns pull-9">
            <%=link_to t('helpers.submit.message.create'), :new_message, class:"submit_button"%>
          </div>
        </div>
      </div>
    </div>
  <% end %>
<%else%>
  <% @messages.each do |m| %>
    <div class="row">
      <div class="small-12 large-12 columns">
        <div class="search_result">
          <div class="small-12 large-6 columns">
            <h3><%=m.title%></h3>
          </div>
          <div class="small-4 large-2 columns">
            <div class="distance">
              <%=m.category.title%>
            </div>
          </div>
          <div class="small-4 large-2 columns">
            <div class="distance">
              <% unless @postal_code.empty? %>
                <%=m.distance.round(1)%> km
              <% end %>
            </div>
          </div>
          <div class="small-4 large-2 columns">
            <div class="time">
              <%=l m.created_at, format: :short_date%>
            </div>
          </div>
          <div class="small-12 large-8 columns search_body">
            <p><%= m.body %></p>
          </div>
          <div class="small-12 large-3 columns">
            <%= link_to t('messages.show.title'), m, class:"result_button"%>
          </div>
        </div>
      </div>
    </div>
  <% end %>
  <% unless @comments == nil || @comments.empty? %>
    <% @comments.each do |c| %>
      <div class="row">
      <div class="small-12 large-12 columns">
        <div class="search_result">
          <div class="small-12 large-6 columns">
            <h3><%=c.message.title%></h3>
          </div>
          <div class="small-4 large-2 columns">
            <div class="distance">
              <%=c.message.category.title%>
            </div>
          </div>
          <div class="small-4 large-2 columns">
            <div class="distance">
              <% unless @postal_code.empty? %>
                <%=c.message.distance.round(1)%> km
              <% end %>
            </div>
          </div>
          <div class="small-4 large-2 columns">
            <div class="time">
              <%=l c.created_at, format: :short_date%>
            </div>
          </div>
          <div class="small-12 large-8 columns search_body">
            <p><%= c.message.body %></p>
          </div>
          <div class="small-12 large-3 columns">
            <%= link_to t('messages.show.title'), c.message, class:"result_button"%>
          </div>
        </div>
      </div>
    </div>
    <% end %>
  <% end %>
<% end %>